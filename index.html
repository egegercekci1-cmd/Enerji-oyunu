<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Enerji Oyunu</title>

<style>
body {
  margin: 0;
  background: #111;
  color: white;
  text-align: center;
  font-family: Arial;
}
canvas {
  display: block;
  background: #222;
  touch-action: none;
}
button {
  font-size: 16px;
  padding: 10px 14px;
  border: none;
  border-radius: 8px;
}
#ui {
  position: fixed;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 10px;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<div id="ui">
  <button id="frictionBtn">üß≤ S√ºrt√ºnme: KAPALI</button>
  <button id="fullscreenBtn">‚õ∂ Tam Ekran</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// üì± TAM EKRAN CANVAS
function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// ‚öôÔ∏è Fƒ∞Zƒ∞K
const g = 0.015;
let frictionOn = false;
let friction = 0.995;

let angle = Math.PI / 6;
let speed = 0;
let dragging = false;

// üî¢ ENERJƒ∞
const TOTAL = 100;
let shownPot = 50;
let shownKin = 50;

// üìç MERKEZ
let L, origin;
function updateOrigin() {
  L = canvas.height * 0.45;
  origin = {
    x: canvas.width / 2,
    y: canvas.height * 0.18
  };
}
updateOrigin();

// üëÜ DOKUNMA
canvas.addEventListener("touchstart", () => dragging = true);
canvas.addEventListener("touchmove", e => {
  if (!dragging) return;
  const t = e.touches[0];
  const r = canvas.getBoundingClientRect();
  const x = t.clientX - r.left - origin.x;
  const y = t.clientY - r.top - origin.y;
  angle = Math.atan2(x, y);
  speed = 0;
});
canvas.addEventListener("touchend", () => dragging = false);

// üß≤ S√úRT√úNME BUTONU
const frictionBtn = document.getElementById("frictionBtn");
frictionBtn.onclick = () => {
  frictionOn = !frictionOn;
  frictionBtn.textContent = frictionOn
    ? "üß≤ S√ºrt√ºnme: A√áIK"
    : "üß≤ S√ºrt√ºnme: KAPALI";
};

// ‚õ∂ TAM EKRAN BUTONU
document.getElementById("fullscreenBtn").onclick = () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
};

// üîÑ G√úNCELLEME
function update() {
  if (!dragging) {
    speed += -g * Math.sin(angle);
    speed *= frictionOn ? friction : 1;
    angle += speed;
  }
}

// üìä BAR
function drawBar(x, y, value, color, label) {
  const w = 220;
  const h = 18;

  ctx.strokeStyle = "white";
  ctx.strokeRect(x, y, w, h);

  ctx.fillStyle = color;
  ctx.fillRect(x, y, w * (value / TOTAL), h);

  ctx.fillStyle = "white";
  ctx.font = "14px Arial";
  ctx.fillText(label + ": " + value.toFixed(0), x, y - 4);
}

// üé® √áƒ∞Zƒ∞M
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const x = origin.x + L * Math.sin(angle);
  const y = origin.y + L * Math.cos(angle);

  // ip
  ctx.beginPath();
  ctx.moveTo(origin.x, origin.y);
  ctx.lineTo(x, y);
  ctx.strokeStyle = "white";
  ctx.lineWidth = 2;
  ctx.stroke();

  // top
  ctx.beginPath();
  ctx.arc(x, y, 22, 0, Math.PI * 2);
  ctx.fillStyle = "orange";
  ctx.fill();

  // enerji hesap
  let realPot = (1 - Math.cos(angle)) * TOTAL;
  realPot = Math.min(realPot, TOTAL);
  let realKin = TOTAL - realPot;

  const smooth = 0.05;
  shownPot += (realPot - shownPot) * smooth;
  shownKin += (realKin - shownKin) * smooth;

  // barlar
  drawBar(20, canvas.height - 100, shownPot, "#3498db", "Potansiyel");
  drawBar(20, canvas.height - 65, shownKin, "#e74c3c", "Kinetik");

  ctx.fillStyle = "white";
  ctx.font = "16px Arial";
  ctx.fillText("Toplam Enerji: 100", 20, canvas.height - 130);
}

// ‚ñ∂Ô∏è OYUN D√ñNG√úS√ú
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>