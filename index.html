<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enerji Oyunu</title>

<style>
body {
  margin: 0;
  background: #111;
  color: white;
  text-align: center;
  font-family: Arial;
}
canvas {
  display: block;
  margin: auto;
  background: #222;
  touch-action: none;
}
</style>
</head>

<body>

<h2>üéÆ Enerjinin Korunumu</h2>
<p>Topu √ßek ‚Üí bƒ±rak</p>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// üì± EKRAN
canvas.width = window.innerWidth;
canvas.height = window.innerHeight * 0.75;

// ‚öôÔ∏è Fƒ∞Zƒ∞K
const g = 0.015;
const L = canvas.height * 0.45;

let angle = Math.PI / 6;
let speed = 0;
let dragging = false;

// üî¢ ENERJƒ∞
const TOTAL = 100;
let shownPot = 50;
let shownKin = 50;

const origin = {
  x: canvas.width / 2,
  y: canvas.height * 0.15
};

// üëÜ DOKUNMA
canvas.addEventListener("touchstart", () => dragging = true);
canvas.addEventListener("touchmove", e => {
  if (!dragging) return;
  const t = e.touches[0];
  const r = canvas.getBoundingClientRect();
  const x = t.clientX - r.left - origin.x;
  const y = t.clientY - r.top - origin.y;
  angle = Math.atan2(x, y);
  speed = 0;
});
canvas.addEventListener("touchend", () => dragging = false);

// üîÑ G√úNCELLEME
function update() {
  if (!dragging) {
    speed += -g * Math.sin(angle);
    speed *= 0.995;
    angle += speed;
  }
}

// üìä BAR
function drawBar(x, y, value, color, label) {
  const w = 220;
  const h = 18;

  ctx.strokeStyle = "white";
  ctx.strokeRect(x, y, w, h);

  ctx.fillStyle = color;
  ctx.fillRect(x, y, w * (value / TOTAL), h);

  ctx.fillStyle = "white";
  ctx.font = "14px Arial";
  ctx.fillText(label + ": " + value.toFixed(0), x, y - 4);
}

// üé® √áƒ∞Zƒ∞M
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const x = origin.x + L * Math.sin(angle);
  const y = origin.y + L * Math.cos(angle);

  // ip
  ctx.beginPath();
  ctx.moveTo(origin.x, origin.y);
  ctx.lineTo(x, y);
  ctx.strokeStyle = "white";
  ctx.lineWidth = 2;
  ctx.stroke();

  // top
  ctx.beginPath();
  ctx.arc(x, y, 22, 0, Math.PI * 2);
  ctx.fillStyle = "orange";
  ctx.fill();

  // enerji hesap
  let realPot = (1 - Math.cos(angle)) * TOTAL;
  realPot = Math.min(realPot, TOTAL);
  let realKin = TOTAL - realPot;

  const smooth = 0.05;
  shownPot += (realPot - shownPot) * smooth;
  shownKin += (realKin - shownKin) * smooth;

  // barlar
  drawBar(20, canvas.height - 90, shownPot, "#3498db", "Potansiyel");
  drawBar(20, canvas.height - 55, shownKin, "#e74c3c", "Kinetik");

  ctx.fillStyle = "white";
  ctx.font = "16px Arial";
  ctx.fillText("Toplam Enerji: 100", 20, canvas.height - 115);
}

// ‚ñ∂Ô∏è OYUN D√ñNG√úS√ú
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>